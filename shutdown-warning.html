<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>关机提醒</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            text-align: center;
            background: #fff7e6;
            margin: 0;
        }
        h3 {
            color: #d32f2f;
            margin: 0 0 15px 0;
        }
        .countdown {
            font-size: 24px;
            font-weight: bold;
            color: #e53935;
            margin: 10px 0;
        }
        .btn {
            margin: 5px;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .delay30 { background: #ffb74d; }
        .delay60 { background: #ff8a65; }
        .close { background: #bdbdbd; }
    </style>
</head>
<body>
    <h3>⚠️ 即将关机提醒</h3>
    <div>系统将在 <span class="countdown">15</span> 秒后自动关机。</div>
    <div>计划关机时间: <span id="targetTime"></span></div>
    <br>
    <button class="btn delay30" id="btn30">延长30秒</button>
    <button class="btn delay60" id="btn60">延长60秒</button>
    <button class="btn close" id="btnClose">继续关机</button>

    <script>
        const { ipcRenderer } = require('electron');

        let seconds = 15;
        let interval;

        window.addEventListener('DOMContentLoaded', () => {
            const targetTimeEl = document.getElementById('targetTime');
            if (window.shutdownTargetTime) {
                targetTimeEl.textContent = window.shutdownTargetTime;
            }

            startCountdown();
        });

        function startCountdown() {
            const countdownEl = document.querySelector('.countdown');
            interval = setInterval(() => {
                seconds--;
                countdownEl.textContent = seconds;
                if (seconds <= 0) {
                    clearInterval(interval);
                    window.close();
                }
            }, 1000);
        }

        document.getElementById('btn30').addEventListener('click', () => {
            clearInterval(interval);
            ipcRenderer.send('shutdown-action', 'delay30');
            window.close();
        });

        document.getElementById('btn60').addEventListener('click', () => {
            clearInterval(interval);
            ipcRenderer.send('shutdown-action', 'delay60');
            window.close();
        });

        document.getElementById('btnClose').addEventListener('click', () => {
            clearInterval(interval);
            ipcRenderer.send('shutdown-action', 'close');
            window.close();
        });
    </script>
</body>
</html>